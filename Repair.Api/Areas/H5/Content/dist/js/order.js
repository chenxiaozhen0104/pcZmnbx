function qrCallBack(e,o){var r=e.substr(e.lastIndexOf("/")+1);r!=$("input[name=QRCode]").val()?AWarnMsg("二维码不正确"+r):"work"==o?order.common.work():"worked"==o?order.common.wordedDialog():AWarnMsg("操作错误")}var order=order||{};order.common={orderType:{0:{description:"未知"},1:{description:"需要维修"},2:{description:"需要保养"}},orderLevel:{0:{description:"未知"},1:{description:"普通工单"},2:{description:"加急工单"}},orderState:{Created:4,Sending:8,Sended:16,Working:32,Worked:64,Unsolved:128,Cancel:256,Close:512,Confirm:1024},userType:{SvcCompanyUser:1,UseCompanyUser:2,SvcCompanyUserAdmin:4,UseCompanyUserAdmin:8,SuperAdmin:16,Common:32},appType:{Use:1,Service:2},stateUse:{8:{description:"派单中",css:"bg_green",btnContent:"取消",func:"order.common.cancel()"},16:{description:"已派单",css:"bg_green",btnContent:"取消",func:"order.common.cancel()"},32:{description:"工作中",css:"bg_green"},64:{description:"未确认",css:"bg_red",btnContent:"确认完成",func:"order.common.confirmDialog()"},128:{description:"未解决",css:"bg_red"},256:{description:"已取消",css:"bg_gray"},512:{description:"已关闭",css:"bg_gray"},1024:{description:"已完成",css:"bg_blue"},2048:{description:"已完成",css:"bg_blue"}},stateSvc:{8:{description:"待派单",css:"bg_orange"},16:{description:"待服务",css:"bg_orange",btnContent:"开始工作",func:"order.common.openQrCode('work')"},32:{description:"工作中",css:"bg_green",btnContent:"工作结束",func:"order.common.openQrCode('worked')"},64:{description:"未确认",css:"bg_orange"},128:{description:"未解决",css:"bg_red",btnContent:"开始工作",func:"order.common.openQrCode('work')"},256:{description:"已取消",css:"bg_gray"},512:{description:"已关闭",css:"bg_gray"},1024:{description:"已完成",css:"bg_gray"},2048:{description:"已完成",css:"bg_gray"}},stateSvcAdmin:{8:{description:"待派单",css:"bg_orange",btnContent:"派单",func:"order.common.dispatchDialog()"},16:{description:"已派单",css:"bg_blue"},32:{description:"工作中",css:"bg_green"},64:{description:"未确认",css:"bg_orange"},128:{description:"未解决",css:"bg_red"},256:{description:"已取消",css:"bg_gray"},512:{description:"已关闭",css:"bg_gray"},1024:{description:"已完成",css:"bg_gray"},2048:{description:"已完成",css:"bg_gray"}},httpParam:new LG.URL,orderId:function(){return order.common.httpParam.get("id")},uType:function(){return parseInt(localStorage.userType)},userId:function(){return parseInt(localStorage.userId)},aType:function(){return parseInt(localStorage.appType)},getOrderLevel:function(e){return order.common.orderLevel[e]},getOrderType:function(e){return order.common.orderType[e]},getState:function(e,o){switch(order.common.aType()){case order.common.appType.Use:return order.common.stateUse[e];case order.common.appType.Service:return o==order.common.userId()?order.common.stateSvc[e]:order.common.uType()&order.common.userType.SvcCompanyUserAdmin?order.common.stateSvcAdmin[e]:order.common.stateSvc[e];default:return order.common.stateUse[e]}},completeCallBack:function(e,o){if(layer.closeAll(),"success"!=o)AErrorMsg("服务器繁忙，请稍后再试试");else{var r=$.parseJSON(e.responseText);r.success?ARightMsg("执行成功"):AErrorMsg("服务器繁忙，请稍后再试试")}setTimeout(function(){window.location.reload()},2e3)},cancel:function(){$(".radio-inline").css("display","none"),$("#workedDialog input:radio[name='workedState'][value='Cancel']").attr("checked",!0),DialogModel($("#workedDialog"),"92%","38%")},work:function(){AComfig("确定提交？",function(){Loading(),$.ajax({url:"/api/order/working",type:"get",data:{orderId:order.common.orderId()},complete:order.common.completeCallBack})})},openQrCode:function(e){window.location.href="http://action?target=_openqrcode&type="+e},wordedDialog:function(){DialogModel($("#workedDialog"),"92%","43%")},worked:function(){var e=$("#workedDialog #description").val(),o=$("#serviceUserId").val(),r=$("#workedDialog input:radio[name='workedState']:checked").val();AComfig((e?"":"您未输入信息,")+"确定提交？",function(){Loading(),$.ajax({url:"/api/order/submitstate",type:"get",data:{orderId:order.common.orderId(),description:e,state:r,level:5,toUserId:o},complete:order.common.completeCallBack})})},dispatchDialog:function(){DialogModel($("#v-user"),"92%","50%")},dispatch:function(e){AComfig("确定派单给["+e.name+"]？",function(){Loading(),$.ajax({url:"/api/order/dispatch",type:"get",data:{orderId:order.common.orderId(),serviceUserId:e.id,serviceUserName:e.name,serviceUserPhone:e.phone},complete:order.common.completeCallBack})})},confirmDialog:function(){$(".radio-inline").css("display","none"),$("#workedDialog input:radio[name='workedState'][value='Confirm']").attr("checked",!0),DialogModel($("#workedDialog"),"92%","38%")},commentDialog:function(){$(".radio-inline").css("display","none"),$(".level").css("display","block"),$("#contentTitle").html("评论内容："),$("#workedDialog input:radio[name='workedState'][value='UseComment']").attr("checked",!0),DialogModel($("#workedDialog"),"92%","40%")},getstatelist:function(){switch(order.common.aType()){case order.common.appType.Use:return[{name:"派单中",val:8},{name:"已派单",val:16},{name:"工作中",val:32},{name:"未确认",val:64},{name:"未评论",val:1024},{name:"进行中",val:1144}];case order.common.appType.Service:return[{name:"待派单",val:8},{name:"待服务",val:16},{name:"工作中",val:32},{name:"未确认",val:64},{name:"未解决",val:128},{name:"进行中",val:1272}];default:return[]}},transferOrder:function(){alert("转单")}},order.paged={url:"/api/order/search",pageIndex:1,curState:1148,pagePage:20,allowPaged:!0,vueModule:new Vue({el:"#orderList",data:{items:[],statelist:order.common.getstatelist()},methods:{search:function(e){order.paged.search(1,order.paged.curState,e)},stateGoto:function(e){order.paged.curState=e,order.paged.search(1,order.paged.curState)}},filters:{stateDescription:function(e,o){return order.common.getState(e,o).description},stateCss:function(e,o){return order.common.getState(e,o).css},typeDescription:function(e){return order.common.getOrderType(e).description},levelDescription:function(e){return order.common.getOrderLevel(e).description}}}),search:function(e,o,r){var n=Loading();$.ajax({url:order.paged.url,type:"post",data:{state:order.paged.curState,atype:order.common.aType(),pageIndex:e,pageSize:order.paged.pagePage},success:function(o){e<2?order.paged.vueModule.items=[].concat(o.data):order.paged.vueModule.items=order.paged.vueModule.items.concat(o.data),o.data.length<order.paged.pagePage&&(order.paged.allowPaged=!1,$("#footerWran").html("<div class='row text-center'>没有工单咯</div>"))},complete:function(){CloseLoad(n),r&&r()}})},paged:function(){$(window).scroll(function(){return!!order.paged.allowPaged&&void($(window).scrollTop()>=$(document).height()-$(window).height()&&(order.paged.pageIndex=parseInt(order.paged.pageIndex)+1,order.paged.search(order.paged.pageIndex)))})},opendetails:function(e){window.location.href="orderdetails.html?id="+e}},order.details={url:"/api/order/get",vueModule:new Vue({el:"#order",data:{items:[]},methods:{selectUser:function(e){order.common.dispatch(e)},search:function(e){order.details.search(e)},getSubmitFunc:function(e,o,r){return order.common.getState(o,r).func[e]},getSubmitContent:function(e,o,r){return order.common.getState(o,r).btnContent[e]}},filters:{stateDescription:function(e,o){return order.common.getState(e,o).description},stateCss:function(e,o){return order.common.getState(e,o).css},typeDescription:function(e){return order.common.getOrderType(e).description},levelDescription:function(e){return order.common.getOrderLevel(e).description},submitCss:function(e,o){var r=order.common.getState(e,o);return r.btnContent?"submitBlock":"submitNone"},submitContent:function(e,o){return order.common.getState(e,o).btnContent},submitFunc:function(e,o){return order.common.getState(e,o).func}}}),search:function(e){var o=Loading();$.ajax({url:order.details.url,type:"post",data:{id:order.common.orderId()},success:function(e){order.details.vueModule.items=[].concat(e)},complete:function(){CloseLoad(o),e&&e()}})}},window.order=order;
//# sourceMappingURL=order.js.map
