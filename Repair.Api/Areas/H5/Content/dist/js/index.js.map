{"version":3,"sources":["index.js"],"names":["openQRCode","actionUrl","LG","URL","ActionBaseUrl","set","window","location","href","url","qrCallBack","eUrl","eStr","substr","lastIndexOf","$","val","document","ready","search","pageIndex","isPage","addClass","get","searchKey","areaId","searchTag","area","categoryId","category","brandId","brand","pageSize","res","len","data","length","html","i","id","name","qrcode","model","address","isPageLoading","show","append","index","removeClass","post","len1","len2","areaText","categoryText","brandText","on","console","log","$t","this","type","children","eq","text","Height","height","click","panelSelector","not","hasClass","scroll","scrollTop","detailId","layer","open","title","closeBtn","shadeClose","shade","content","QRCode","Position","Name","Area","Category","Model","rqCode","undefined","msg","icon","time","ajax","deviceId","qrCode","success","obj","error","alert","find","remove","closeAll"],"mappings":"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","file":"index.js","sourcesContent":["$(document).ready(function () {\r\n\r\n    var Height = $(window).height() - 92;\r\n    $(\".show-panel\").height(Height); \r\n\r\n\r\n    $(\".chooseList>.col-xs-4\").click(function () {\r\n        var $t = $(this)\r\n        var panelSelector = $(this).data('panel')\r\n        $('.ddl').not(this).removeClass('checked');\r\n        if ($t.hasClass('checked')) {\r\n            $t.removeClass('checked')\r\n            $(panelSelector).removeClass('show')\r\n        } else {\r\n            $t.addClass('checked')\r\n            $('.show-panel').not(panelSelector).removeClass('show');\r\n            $(panelSelector).addClass('show')\r\n        }\r\n    });\r\n\r\n    //$(\".area>span\").click(function() {\r\n    //   $(\".area>span\").removeClass('spanClick')\r\n    //   $(this).addClass('spanClick');\r\n    //   $(\".ddl\").eq(0).find(\"span\").first().text($(this).html());\r\n    //   $('.show-panel').removeClass('show');\r\n    //});\r\n    //$(\".category>span\").click(function() {\r\n    //   $(\".category>span\").removeClass('spanClick')\r\n    //   $(this).addClass('spanClick');\r\n    //   $(\".ddl\").eq(1).find(\"span\").first().text($(this).html());\r\n    //   $('.show-panel').removeClass('show');\r\n    //});\r\n    // $(\".brand>span\").click(function() {\r\n    //   $(\".brand>span\").removeClass('spanClick')\r\n    //   $(this).addClass('spanClick');\r\n    //   $(\".ddl\").eq(2).find(\"span\").first().text($(this).html());\r\n    //   $('.show-panel').removeClass('show');\r\n    //});\r\n\r\n    $(\".icon-sou\").click(function () {\r\n        $(\".clickSerch\").addClass('moveSerch');\r\n    });\r\n\r\n    $(\".btn,.search-back\").click(function () {\r\n        $(\".clickSerch\").removeClass('moveSerch');\r\n    });\r\n\r\n\r\n    var searchTag = {\r\n        area: null,\r\n        category: null,\r\n        brand: null\r\n    }\r\n    var index = 1;\r\n    var isPageLoading=false;\r\n    function search(pageIndex,isPage) {\r\n        $(\".loading\").addClass(\"show\");\r\n        $.get('/api/device/search', {\r\n            searchKey: $('#txt-key').val(),\r\n            areaId: searchTag.area,\r\n            categoryId: searchTag.category,\r\n            brandId: searchTag.brand,\r\n            pageIndex: pageIndex || 1,\r\n            pageSize:20\r\n        }, function (res) {\r\n\r\n\r\n            var len = res.data.length;\r\n            var data = res.data;\r\n            var html = \"\";\r\n            for (var i = 0 ; i < len; i++) {\r\n                html += \"<a id='\" + data[i].id + \"' class='list-group-item row device-item'>\" +\r\n                  \"<div class='col-xs-10'>\" +\r\n                      \"<div class='list-group-item-heading'>\" + data[i].name+\"<span class='qrcode'>\"+ (data[i].qrcode||\"\")+\"</span></div>\" +\r\n                      \"<div class='row list-group-item-text'>\" +\r\n                         \"<p class='col-xs-8'>类目：\" + data[i].category + \"</p>\" +\r\n                           \"<p class='col-xs-4'>品牌：\" + (data[i].brand || '暂无') + \"</p>\" +\r\n                      \"</div>\" +\r\n                     \"<div class='row list-group-item-text'>\" +\r\n                         \"<p class='col-xs-8'>型号：\" + (data[i].model || '暂无') + \"</p>\" +\r\n                          \"<p class='col-xs-4'>区域：\" + data[i].area + \"</p>\" +  \r\n                      \"</div>\" +\r\n                      \"<div class='row list-group-item-text'>\" +\r\n                         \"<p class='col-xs-12'>安装地址：\" + (data[i].address || '暂无')+ \"</p>\" +\r\n                      \"</div>\" +\r\n                  \"</div>\" +\r\n                  \"<div class='col-xs-2 text-center'>\" +\r\n                      (data[i].qrcode ? \"\" : \"<div class='iconfont icon-erweima' style='font-size:30px;'></div>\") +\r\n                  \"</div>\" +\r\n              \"</a>\"\r\n            }\r\n            if (!isPage) {\r\n                $(\".list-group\").html(html);\r\n                index = 1;\r\n                isPageLoading = false;\r\n            } else {\r\n                isPageLoading = data.length == 0;\r\n                $('.nodata').show();\r\n                $(\".list-group\").append(html);\r\n            }\r\n            \r\n            $(\".loading\").removeClass(\"show\");\r\n           \r\n        });\r\n\r\n\r\n    }\r\n\r\n    search();\r\n\r\n    $(window).scroll(function () {\r\n       \r\n\r\n        if ($(document).scrollTop() >= $(document).height() - $(window).height() - 20&&!isPageLoading) {\r\n            index++;\r\n            search(index,true);\r\n        }\r\n    })\r\n\r\n    function brand() {\r\n        $.post(\"/api/device/initData\", function (res) {\r\n            var len = res.area.length;\r\n            var len1 = res.category.length;\r\n            var len2 = res.brand.length;\r\n            var areaText = \"\";\r\n            var categoryText = \"\";\r\n            var brandText = \"\";\r\n\r\n            for (var i = 0 ; i < len; i++) {\r\n                areaText += \"<span class='search-tag' data-type='area' data-id='\" + res.area[i].id + \"'>\" + res.area[i].name + \"</span>\"\r\n            }\r\n            $(\".area\").append(areaText);\r\n            for (var i = 0 ; i < len1; i++) {\r\n                categoryText += \"<span class='search-tag' data-type='category' data-id='\" + res.category[i].id + \"'>\" + res.category[i].name + \"</span>\"\r\n            }\r\n            $(\".category\").append(categoryText);\r\n            for (var i = 0 ; i < len2; i++) {\r\n                brandText += \"<span class='search-tag' data-type='brand' data-id='\" + res.brand[i].id + \"'>\" + res.brand[i].name + \"</span>\"\r\n            }\r\n            $(\".brand\").append(brandText);\r\n\r\n\r\n        })\r\n        $('.show-panel').on('click', 'span', function () {\r\n            console.log(123)\r\n            $('.show-panel').removeClass('show');\r\n            var $t = $(this);\r\n            var type = $t.data('type');\r\n            $('.ddl-' + type).children().eq(0).text($t.text())\r\n            searchTag[type] = $t.data('id');\r\n            $('.ddl').removeClass('checked')\r\n            search();\r\n        });\r\n    }\r\n    brand()\r\n\r\n\r\n\r\n    // 搜索的oninput事件;\r\n    $(\"#txt-key\").on(\"input\", function () {\r\n        search();\r\n    })\r\n   \r\n\r\n    var detailId;\r\n    $(\".list-group\").on('click', '.device-item', function () {\r\n        //$('.bounceds').addClass('show');\r\n       layer.open({\r\n            type: 1,\r\n            title: false,\r\n            closeBtn: 1,\r\n            shadeClose: false,\r\n            shade: [0.3, '#393D49'],\r\n            //area: [100, height],\r\n            content: $('.bounceds')\r\n        });\r\n        detailId = this.id;\r\n        $.get(\"/api/device/get?deviceId=\" + this.id, function (res) {\r\n            console.log(res)\r\n            if (res) {\r\n                $('#txtQrCode').val(res.QRCode)\r\n                $('#txtLocation').val(res.Position)\r\n                $(\".deviceName\").text(res.Name);\r\n                $(\".areaName\").text(res.Area.Name);\r\n                $(\".categoryName\").text(res.Category.Name);\r\n                $(\".modelName\").text(res.Model);\r\n            }\r\n        })\r\n    })\r\n    $('#btn-submit').click(function () {\r\n        var actionUrl = new LG.URL();\r\n\r\n        var rqCode = $(\"#txtQrCode\").val();\r\n        if (rqCode == \"\" || rqCode == undefined) {\r\n            layer.msg('二维码为空！', { icon: 2, time: 1500 });\r\n            return;\r\n        }\r\n        var address = $(\"#txtLocation\").val();\r\n\r\n\r\n        $.ajax({\r\n            url: \"/api/device/setQRCode\",\r\n            type: \"post\",\r\n            data: { \"deviceId\": detailId, \"qrCode\": rqCode, \"address\": address },\r\n            success: function (obj) {\r\n                var timeOut = 2000;\r\n                if (obj.error) {\r\n                    layer.alert(obj.error,{icon:0})\r\n                }\r\n                else {\r\n                  \r\n                    $('#' + detailId).find('.icon-erweima').remove()\r\n                    layer.closeAll();\r\n                    layer.msg(\"保存成功\", { icon: 6, time: 1000 });\r\n                }\r\n            }\r\n        });\r\n    })\r\n\r\n    $(\"#btn-close\").click(function () {\r\n        $('.bounceds').removeClass('show');\r\n    });\r\n    $(\"#btn-repair\").click(function () {\r\n        location.href = \"deviceDetail.html?deviceId=\" + detailId;\r\n    })\r\n\r\n});\r\n\r\n\r\n\r\n\r\nfunction openQRCode() {\r\n    var actionUrl = new LG.URL(ActionBaseUrl);\r\n\r\n\r\n    actionUrl.set(\"target\", \"_openqrcode\");\r\n    window.location.href = actionUrl.url();\r\n}\r\n\r\nfunction qrCallBack(eUrl) {\r\n    var eStr = eUrl.substr(eUrl.lastIndexOf('/') + 1);\r\n\r\n    $(\"#txtQrCode\").val(eStr);\r\n}\r\n\r\n\r\n\r\n"]}