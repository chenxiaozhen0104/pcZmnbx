{"version":3,"sources":["login.js"],"names":["cacheUser","res","localStorage","userId","id","userName","name","userType","type","userPhone","phone","appType","reg","RegExp","r","window","location","search","substr","match","unescape","undefined","login","Vue","el","data","passwordLogin","password","logo","mobile","smsCode","methods","index","layer","msg","icon","time","shadeClose","this","$","post","error","close","userInfo","get","useCompany","href","serviceCompany"],"mappings":"AAAA,QAASA,WAAUC,GACfC,aAAaC,OAASF,EAAIG,GAAK,GAC/BF,aAAaG,SAAWJ,EAAIK,KAC5BJ,aAAaK,SAAWN,EAAIO,KAC5BN,aAAaO,UAAYR,EAAIS,MAIjCR,aAAaS,QAAU,WAEnB,GAAIC,GAAM,GAAIC,QAAO,6BACjBC,EAAIC,OAAOC,SAASC,OAAOC,OAAO,GAAGC,MAAMP,GAE3CJ,EAAY,MAALM,EAAYM,SAASN,EAAE,IAAMO,MAExC,OAAOb,KAGX,IAAIc,OAAQ,GAAIC,MACZC,GAAI,WACJC,MACIC,eAAe,EACfrB,SAAU,GACVsB,SAAU,GACVC,KAA8B,GAAxB1B,aAAaS,QAAe,2BAA6B,kCAC/DkB,OAAQ,GACRC,QAAS,IAEbC,SACIT,MAAO,WACH,GAAIU,GAAQC,MAAMC,IAAI,UAAYC,KAAM,GAAIC,KAAM,EAAGC,YAAY,GAC7DC,MAAKZ,cACLa,EAAEC,KAAK,2BAA6BnC,SAAUiC,KAAKjC,SAAUsB,SAAUW,KAAKX,UAAY,SAAU1B,GAC1FA,EAAIwC,OACJR,MAAMC,IAAIjC,EAAIwC,OAASN,KAAM,EAAGC,KAAM,MACtCH,MAAMS,MAAMV,KAEZhC,UAAUC,GACVqB,MAAMqB,cAUdJ,EAAEC,KAAK,sBAAwBV,QAASQ,KAAKR,QAASD,OAAQS,KAAKT,QAAU,SAAU5B,GAC/EA,EAAIwC,OACJR,MAAMC,IAAIjC,EAAIwC,OAASN,KAAM,EAAGC,KAAM,MACtCH,MAAMS,MAAMV,KAEZhC,UAAUC,GACVqB,MAAMqB,eAMtBA,SAAU,WACNJ,EAAEK,IAAI,iBAAkB,SAAU3C,GACF,GAAxBC,aAAaS,QACTV,EAAI4C,WACJ7B,SAAS8B,KAAO,kDAAoD5C,aAAaS,QAEjFK,SAAS8B,KAAO,uDAAyD5C,aAAaS,QAGtFV,EAAI8C,eACJ/B,SAAS8B,KAAO,qDAAuD5C,aAAaS,QAEpFK,SAAS8B,KAAO,uDAAyD5C,aAAaS","file":"login.js","sourcesContent":["function cacheUser(res) {\r\n    localStorage.userId = res.id + '';\r\n    localStorage.userName = res.name;\r\n    localStorage.userType = res.type;\r\n    localStorage.userPhone = res.phone;\r\n}\r\n//localStorage.clear();\r\n\r\nlocalStorage.appType = (function () {\r\n\r\n    var reg = new RegExp(\"(^|&)appType=([^&]*)(&|$)\");\r\n    var r = window.location.search.substr(1).match(reg);\r\n\r\n    var type = r != null ? unescape(r[2]) : undefined;\r\n\r\n    return type;\r\n})();\r\n\r\nvar login = new Vue({\r\n    el: '#content',\r\n    data: {\r\n        passwordLogin: false,\r\n        userName: '',\r\n        password: '',\r\n        logo: localStorage.appType == 1 ? '../images/login_logo.png' : '../images/login_logoservice.png',\r\n        mobile: '',\r\n        smsCode: ''\r\n    },\r\n    methods: {\r\n        login: function () {\r\n            var index = layer.msg(\"登录中...\", { icon: 16, time: 0, shadeClose: false });\r\n            if (this.passwordLogin) {\r\n                $.post('/api/user/PasswordLogin', { userName: this.userName, password: this.password }, function (res) {\r\n                    if (res.error) {\r\n                        layer.msg(res.error, { icon: 2, time: 2000 })\r\n                        layer.close(index)\r\n                    } else {\r\n                        cacheUser(res);\r\n                        login.userInfo();\r\n                        //if (localStorage.appType == 2) {//用户如果是服务单位管理员或普通人员，跳转到订单列表\r\n                        //    //location.href = \"orderlist.html?target=_blank_closecurrent&appType=\" + localStorage.appType\r\n                        //} else if (localStorage.appType == 1) {\r\n                        //    location.href = \"CompanyType.html?target=_blank_closecurrent&appType=\" + localStorage.appType\r\n                        //    //location.href = \"repair.html?target=_blank_closecurrent&appType=\" + localStorage.appType\r\n                        //}\r\n                    }\r\n                })\r\n            } else {\r\n                $.post('/api/user/SMSLogin', { smsCode: this.smsCode, mobile: this.mobile }, function (res) {\r\n                    if (res.error) {\r\n                        layer.msg(res.error, { icon: 2, time: 2000 })\r\n                        layer.close(index)\r\n                    } else {\r\n                        cacheUser(res)\r\n                        login.userInfo();\r\n                    }\r\n                })\r\n            }\r\n        },\r\n\r\n        userInfo: function () {\r\n            $.get(\"/api/user/Info\", function (res) {\r\n                if (localStorage.appType == 1) {\r\n                    if (res.useCompany)\r\n                        location.href = \"repair.html?target=_blank_closecurrent&appType=\" + localStorage.appType\r\n                    else {\r\n                        location.href = \"CompanyType.html?target=_blank_closecurrent&appType=\" + localStorage.appType\r\n                    }\r\n                } else {\r\n                    if (res.serviceCompany)\r\n                        location.href = \"orderlist.html?target=_blank_closecurrent&appType=\" + localStorage.appType\r\n                    else\r\n                        location.href = \"CompanyType.html?target=_blank_closecurrent&appType=\" + localStorage.appType\r\n                }\r\n            });\r\n        }\r\n    }\r\n})"]}