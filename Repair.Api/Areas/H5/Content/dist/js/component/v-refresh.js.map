{"version":3,"sources":["component/v-refresh.js"],"names":["beginY","threshold","thresholdLog","Math","log","y","dy","canDrop","Vue","component","props","template","data","tip","showDone","showTip","tipStyle","transition","clip","style","transform","methods","touchstart","e","touches","clientY","touchend","this","_start","_cancel","touchmove","window","scrollY","max","showLoading","start","_done","created"],"mappings":"CAAA,WACI,GAAIA,GAAQC,EAAY,EAAGC,EAAeC,KAAKC,IAAIH,GAAYI,EAAI,EAAGC,EAAK,GAAIC,GAAU,CACzFC,KAAIC,UAAU,aACVC,OAAQ,MAAO,QAAS,eACxBC,SAAU,2ZASVC,KAAM,WACF,OACIC,IAAK,OACLC,UAAU,EACVC,SAAS,EACTC,UACIC,WAAY,OACZC,KAAM,4BAEVC,OACIF,WAAY,OACZG,UAAW,wBAIvBC,SACIC,WAAY,SAAUC,GAClBvB,EAASuB,EAAEC,QAAQ,GAAGC,SAE1BC,SAAU,SAAUH,GAEhB,GADAI,KAAKR,MAAMF,WAAa,YACpBZ,EAAIC,EAAI,CACRqB,KAAKC,aAGLD,MAAKE,WAGbC,UAAW,SAAUP,GACZhB,GAA6B,GAAlBwB,OAAOC,UAGvB3B,EAAIF,KAAK8B,IAAI,EAAIV,EAAEC,QAAQ,GAAGC,QAAUzB,GACxCK,EAAIJ,GAAaI,EAAIJ,GAAaC,EAAeC,KAAKC,IAAIC,GAC1DsB,KAAKd,IAAMR,EAAIC,EAAK,SAAW,SAC/BqB,KAAKR,MAAMC,UAAY,iBAAmBf,EAAI,QAC9CsB,KAAKX,SAASE,KAAO,QAAUf,KAAK8B,IAAI,GAAK5B,EAAG,GAAK,sBAErDsB,KAAKR,MAAMF,WAAa,OACxBU,KAAKX,SAASC,WAAa,SAE/BW,OAAQ,WACJrB,GAAU,EACNoB,KAAKO,cACLP,KAAKR,MAAMC,UAAY,wBACvBO,KAAKd,IAAM,+CAEfc,KAAKQ,OAASR,KAAKQ,MAAMR,KAAKS,QAElCP,QAAS,WACLF,KAAKX,SAASC,WAAa,YAC3BU,KAAKX,SAASE,KAAO,2BACrBb,EAAI,EACJE,GAAU,EACVoB,KAAKR,MAAMC,UAAY,sBAE3BgB,MAAO,WACHT,KAAKE,YAGbQ,QAAS","file":"v-refresh.js","sourcesContent":["(function () {\r\n    var beginY, threshold = 5, thresholdLog = Math.log(threshold), y = 0, dy = 50, canDrop = true\r\n    Vue.component('v-refresh', {\r\n        props: ['css', 'start', 'showLoading'],\r\n        template: '<div style=\"position:relative\" :class=\"css\">\\\r\n         <div style=\"position:absolute;z-index:5;font-size:16px;width:100%;text-align:center;height:25px;\" :style=\"tipStyle\" v-html=\"tip\"></div>\\\r\n         <div style=\"line-height:25px;text-align:center\" v-show=\"showDone\">加载完成</div>\\\r\n         <div @touchstart=\"touchstart\" @touchend=\"touchend\" @touchmove=\"touchmove\" :style=\"style\"><slot>暂时没有更多内容</slot></div>\\\r\n    </div>',\r\n        data: function () {\r\n            return {\r\n                tip: '下拉刷新',\r\n                showDone: false,\r\n                showTip: false,\r\n                tipStyle: {\r\n                    transition: 'none',\r\n                    clip: 'rect(25px,1000px,25px,0)'\r\n                },\r\n                style: {\r\n                    transition: 'none',\r\n                    transform: 'translate3d(0,0,0)',\r\n                }\r\n            }\r\n        },\r\n        methods: {\r\n            touchstart: function (e) {\r\n                beginY = e.touches[0].clientY\r\n            },\r\n            touchend: function (e) {\r\n                this.style.transition = 'all 300ms'\r\n                if (y > dy) {\r\n                    this._start()\r\n                    var self = this\r\n                } else {\r\n                    this._cancel()\r\n                }\r\n            },\r\n            touchmove: function (e) {\r\n                if (!canDrop || window.scrollY != 0) {\r\n                    return\r\n                }\r\n                y = Math.max(0, (e.touches[0].clientY - beginY));\r\n                y = threshold + (y - threshold) * thresholdLog / Math.log(y)\r\n                this.tip = y > dy ? '↑ 松开刷新' : '↓ 下拉刷新'\r\n                this.style.transform = 'translate3d(0,' + y + 'px,0)'\r\n                this.tipStyle.clip = 'rect(' + Math.max(25 - y, 0) + 'px,1000px,25px,0px)'\r\n\r\n                this.style.transition = 'none'\r\n                this.tipStyle.transition = 'none'\r\n            },\r\n            _start: function () {\r\n                canDrop = false\r\n                if (this.showLoading) {\r\n                    this.style.transform = 'translate3d(0,25px,0)'\r\n                    this.tip = '<i class=\"iconfont icon-loading\"></i>加载中...'\r\n                }\r\n                this.start && this.start(this._done)\r\n            },\r\n            _cancel: function () {\r\n                this.tipStyle.transition = 'all 300ms'\r\n                this.tipStyle.clip = 'rect(25px,1000px,25px,0)'\r\n                y = 0\r\n                canDrop = true\r\n                this.style.transform = 'translate3d(0,0,0)'\r\n            },\r\n            _done: function () {\r\n                this._cancel()\r\n            }\r\n        },\r\n        created: function () {\r\n            //document.body.ontouchmove = function (e) {\r\n            //    e.preventDefault();\r\n            //}\r\n        }\r\n    })\r\n\r\n})()"]}