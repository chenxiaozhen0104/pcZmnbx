<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><title>公司基本信息</title><link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link href="../css/my.css" rel="stylesheet"><link href="//at.alicdn.com/t/font_newtymnvzenuerk9.css" rel="stylesheet"><link href="../css/component.css" rel="stylesheet"><link rel="stylesheet" href="../css/index.css"><style>.person-details{margin-top:20px}.btn{width:75%;background:#f0ad4e;border:none;height:40px;color:#fff}.btn:active{background:#ffd800}.greenColor{background-color:green}.category-cursor{cursor:pointer}</style></head><body><div id="UserCompanyInfo"><nav class="navbar navbar-fixed-top"><div class="person-info text-center"><a class="iconfont icon-fanhui btn-back" v-on:click="Back"></a> 公司基本信息</div></nav><ul class="person-details list-group"><li class="list-group-item row"><input type="hidden" v-model="CompanyInfoId" name="CompanyInfoId"> <input type="hidden" v-model="Categorys" name="Categorys"><div class="col-xs-4 text-right" style="padding-top:8px">公司名称:</div><div class="col-xs-8 text-right row-right"><input class="form-control" v-model="Name" placeholder="请输入公司名称" type="text" required></div></li><li class="list-group-item row"><div class="col-xs-4 text-right" style="padding-top:8px">联系人:</div><div class="col-xs-8 text-right row-right"><input class="form-control" v-model="Contact" placeholder="请输入联系人" type="text"></div></li><li class="list-group-item row"><div class="col-xs-4 text-right" style="padding-top:8px">联系电话:</div><div class="col-xs-8 text-right row-right"><input class="form-control" v-model="Phone" placeholder="请输入联系电话" type="tel"></div></li><li class="list-group-item row"><div class="col-xs-4 text-right" style="padding-top:8px">地址:</div><div class="col-xs-8 text-right row-right"><input class="form-control" v-model="Position" placeholder="请输入地址" type="text"></div></li><li class="list-group-item row" v-show="show"><div class="col-xs-4 text-right" style="padding-top:8px">服务范围:</div><div class="col-xs-8 text-right row-right"><input class="form-control" v-model="CategorysName" placeholder="请选择服务范围" type="text" readonly="readonly" v-on:click="showCategorys"></div></li><li class="list-group-item row" v-show="show"><div class="col-xs-4 text-right">是否生产厂家:</div><div class="col-xs-8 text-left row-right"><input type="checkbox" checked="checked" v-model="IsManufacturer"></div></li><li class="list-group-item row" v-show="show"><div class="col-xs-4 text-right" style="padding-top:8px">营业执照:</div><div class="col-xs-8 text-right row-right"><form enctype="multipart/form-data"><input class="form-control" placeholder="营业执照" type="file" v-model="ImgUrl" @change="getFile"></form></div></li><li class="list-group-item row" v-show="State"><div class="col-xs-4 text-right" style="color:red">不通过原因:</div><div class="col-xs-8 text-left row-right"><label>{{Note}}</label></div></li><li><div class="text-center" style="margin-top:30px"><button v-on:click="submitCompanyInfo" class="btn">提 交</button></div></li></ul><div class="area" v-show="categoryPanel" id="category-show-panel"><span class="search-tag category-cursor" v-bind:class="{ greenColor:!!category.Category.isSelect }" data-id="{{category.Category.CategoryId}}" v-for="category in categorys" v-on:click="getSelectItem(category.Category)">{{category.Category.CNName}}</span></div></div></body></html><script src="../js/jquery-3.1.0.js"></script><script src="../common/layer/layer.js"></script><script src="../common/LayerFunction.js"></script><script src="../common/httpParams.js"></script><script src="../common/vue.js"></script><script>var CompanyInfo=new Vue({el:"#UserCompanyInfo",data:{Name:"",State:!1,CompanyInfoId:"",Contact:"",Phone:"",Note:"",Position:"",returnUrl:(new LG.URL).get("personDetails"),Categorys:"",CategorysName:"",IsManufacturer:"",ImgUrl:"",categoryPanel:!1,categorys:[],file:[],show:2==localStorage.appType},methods:{getFile:function(t){this.file=t.target.files},getSelectItem:function(t){t.isSelect=!t.isSelect},showCategorys:function(){this.categoryPanel=!0;var t=this;layer.open({title:"技能标签",type:1,closeBtn:!1,content:$("#category-show-panel"),btn:["确定","取消"],btnAlign:"c",success:function(t){t.find(".layui-layer-btn").css("text-align","center")},yes:function(e,o){t.categorys.forEach(function(e){e.Category.isSelect&&(t.CategorysName+=e.Category.CNName+";",t.Categorys+=e.Category.CategoryId+",")}),CloseLoad(e)},cancel:function(t){}})},Back:function(){this.returnUrl?location.href=this.returnUrl+".html":location.href="CompanyType.html"},submitCompanyInfo:function(){if(!(this.Name&&this.Contact&&this.Phone&&this.Position))return void layer.msg("请填写完整信息",{icon:0});if(!localStorage.userId)return void layer.msg("数据错误,请从新登录",{icon:0});if(1==localStorage.appType)$.post("/api/user/companyinfo",{Name:this.Name,Contact:this.Contact,Phone:this.Phone,Position:this.Position,UseCompanyId:0|this.CompanyInfoId},function(t){t.error?layer.alert(t.error,{icon:0}):layer.msg("申请已提交，请耐心等待审核",{icon:1,time:2e3},function(){this.returnUrl?location.href=this.returnUrl+".html":location.href="repair.html?target=_blank_closecurrent&appType="+localStorage.appType})});else if(2==localStorage.appType){var t=new FormData,e={Name:this.Name,Contact:this.Contact,Phone:this.Phone,Position:this.Position,ServiceCompanyId:0|this.CompanyInfoId,Categorys:this.Categorys,IsManufacturer:this.IsManufacturer?1:0};t.append("file",this.file.length>0?this.file[0]:""),t.append("servicecompany",JSON.stringify(e)),$.ajax({url:"/api/user/servicecompany",type:"POST",data:t,contentType:!1,processData:!1,success:function(t){t.error?layer.alert(t.error,{icon:0}):layer.msg("申请已提交，请耐心等待审核",{icon:1,time:2e3},function(){this.returnUrl?location.href=this.returnUrl+".html":location.href="orderlist.html?target=_blank_closecurrent&appType="+localStorage.appType})}})}}},created:function(){var t=this;$.get("/api/user/getcompanyinfo",{appType:localStorage.appType},function(e){t.Name=e.Name,t.State="4"==e.State,t.CompanyInfoId=e.Id,t.Contact=e.Contact,t.Phone=e.Phone,t.Note=e.Note,t.Position=e.Position}),$.get("/api/user/getcategorylist",function(e){t.categorys=e.filter(function(t){return t.Category.isSelect=!1,!0})})}})</script>